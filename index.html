<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ğŸ® AIäººç”Ÿæ¨¡æ‹Ÿå™¨</title>
<style>
body{font-family:'Microsoft YaHei';background:#1a1a2e;color:#fff;padding:20px;margin:0}
.game-container{max-width:800px;margin:0 auto}
.year-display{text-align:center;font-size:24px;color:#ffd700;margin-bottom:20px}
.status-bar{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap}
.stat-item{background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;min-width:80px;text-align:center}
.stat-label{font-size:10px;color:#888}
.stat-value{font-size:18px;font-weight:bold}
.main-area{display:grid;grid-template-columns:200px 1fr;gap:20px}
.avatar{font-size:50px;text-align:center;margin-bottom:10px}
.char-name{text-align:center;font-size:18px;margin-bottom:5px}
.char-info{text-align:center;color:#888;font-size:12px}
.skills-list{display:flex;flex-wrap:wrap;gap:5px;margin-top:10px}
.skill-tag{background:rgba(255,255,255,0.1);padding:3px 8px;border-radius:10px;font-size:11px}
.event-log{font-size:11px;max-height:150px;overflow-y:auto;margin-top:10px}
.story-panel{background:rgba(0,0,0,0.3);padding:15px;border-radius:10px}
.scene-image{font-size:40px;text-align:center;margin-bottom:10px}
.npc-area{display:flex;gap:10px;margin-bottom:10px}
.npc-avatar{font-size:30px}
.dialogue-box{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px;flex:1}
.npc-name{color:#ffd700;font-size:12px;margin-bottom:5px}
.choices-title{font-size:14px;color:#00ccff;margin:10px 0}
.choice-btn{display:block;width:100%;padding:12px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff;text-align:left;margin-bottom:8px;cursor:pointer}
.choice-btn:hover{background:rgba(0,255,136,0.2);border-color:#00ff88}
.result-box{background:rgba(0,255,136,0.2);padding:15px;border-radius:8px;margin-bottom:10px}
.free-input{margin-top:15px}
.free-input input{width:100%;padding:10px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff}
.free-input button{margin-top:8px;padding:10px 20px;background:#00ff88;border:none;border-radius:8px;color:#000;font-weight:bold;cursor:pointer}
@media(max-width:600px){.main-area{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="game-container">
<div class="year-display" id="yearDisplay">ç¬¬ 0 å¹´</div>
<div class="status-bar">
<div class="stat-item"><div class="stat-label">å¥åº·</div><div class="stat-value" id="health">100</div></div>
<div class="stat-item"><div class="stat-label">é‡‘é’±</div><div class="stat-value" id="money">Â¥0</div></div>
<div class="stat-item"><div class="stat-label">æ™ºåŠ›</div><div class="stat-value" id="intelligence">50</div></div>
<div class="stat-item"><div class="stat-label">é­…åŠ›</div><div class="stat-value" id="charm">50</div></div>
<div class="stat-item"><div class="stat-label">å¹¸è¿</div><div class="stat-value" id="luck">50</div></div>
<div class="stat-item"><div class="stat-label">å£°æœ›</div><div class="stat-value" id="fame">0</div></div>
</div>
<div class="main-area">
<div class="left-panel">
<div class="avatar" id="avatar">ğŸ‘¶</div>
<div class="char-name" id="charName">å©´å„¿</div>
<div class="char-info" id="charInfo">0å²</div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">æŠ€èƒ½</div><div class="skills-list" id="skillsList"><span class="skill-tag">æ— </span></div></div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">ç»å†</div><div class="event-log" id="eventLog"><div>ğŸŒŸ ä½ å‡ºç”Ÿäº†</div></div></div>
</div>
<div class="center-area">
<div class="story-panel">
<div class="scene-image" id="sceneImage">ğŸ¥</div>
<div class="npc-area"><div class="npc-avatar" id="npcAvatar">ğŸ‘©</div><div class="dialogue-box"><div class="npc-name" id="npcName">å¦ˆå¦ˆ</div><div id="dialogueText">å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼</div></div></div>
</div>
<div class="choices-panel" id="choicesPanel">
<div class="choices-title">ä½ å†³å®šï¼š</div>
<div id="choicesList"></div>
<div class="free-input"><input type="text" id="freeInput" placeholder="è¾“å…¥ä½ çš„æƒ³æ³•ï¼ŒAIç”Ÿæˆé€‰æ‹©"><button id="submitBtn">æäº¤</button></div>
</div>
</div>
</div>
</div>
<script>
// æ¸¸æˆçŠ¶æ€
var gameState = {
    age: 0,
    health: 100,
    money: 0,
    intelligence: 50,
    charm: 50,
    luck: 50,
    fame: 0,
    skills: [],
    events: [],
    job: "å©´å„¿",
    relationship: 0,
    careerLevel: 0
};

// é¢„è®¾äº‹ä»¶
var events = {
    0: {
        npc: "å¦ˆå¦ˆ",
        scene: "ğŸ¥",
        avatar: "ğŸ‘©",
        dialogue: "å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼",
        choices: [
            { text: "å¥åº·æˆé•¿", effect: { health: 10 }, result: "ä½ å¥åº·æˆé•¿ç€ã€‚" },
            { text: "å“­é—¹è¡¨è¾¾", effect: { charm: 5 }, result: "ä½ ç”¨å“­é—¹æ¥è¡¨è¾¾éœ€æ±‚ã€‚" },
            { text: "å®‰é™ç¡è§‰", effect: { health: 5 }, result: "ä½ å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç¡è§‰ã€‚" },
            { text: "å¥½å¥‡è§‚å¯Ÿ", effect: { intelligence: 5 }, result: "ä½ å¥½å¥‡åœ°è§‚å¯Ÿç€ä¸–ç•Œã€‚" }
        ]
    },
    3: {
        npc: "çˆ¸çˆ¸",
        scene: "ğŸ ",
        avatar: "ğŸ‘¨",
        dialogue: "3å²äº†ï¼Œè¯¥å­¦ç‚¹ä»€ä¹ˆäº†ã€‚",
        choices: [
            { text: "ç©ç©å…·è½¦", effect: { intelligence: 10, skill: "æœºæ¢°" }, result: "ä½ å±•ç°æœºæ¢°å¤©èµ‹ï¼" },
            { text: "ç”»ç”»", effect: { intelligence: 5, skill: "ç»˜ç”»" }, result: "ä½ å–œæ¬¢ç”»ç”»ã€‚" },
            { text: "å’Œå…¶ä»–å°æœ‹å‹ç©", effect: { charm: 10, skill: "ç¤¾äº¤" }, result: "ä½ äº¤åˆ°äº†ç¬¬ä¸€ä¸ªæœ‹å‹ï¼" },
            { text: "å¬æ•…äº‹", effect: { intelligence: 10 }, result: "ä½ å¾ˆå–œæ¬¢å¬æ•…äº‹ã€‚" }
        ]
    },
    6: {
        npc: "è€å¸ˆ",
        scene: "ğŸ«",
        avatar: "ğŸ‘¨â€ğŸ«",
        dialogue: "ä¸Šå°å­¦äº†ï¼ä½ æœ€å–œæ¬¢å“ªé—¨è¯¾ï¼Ÿ",
        choices: [
            { text: "æ•°å­¦è¯¾", effect: { intelligence: 15, skill: "æ•°å­¦" }, result: "ä½ å±•ç°äº†æ•°å­¦å¤©èµ‹ï¼" },
            { text: "è¯­æ–‡è¯¾", effect: { intelligence: 10, skill: "è¯­æ–‡" }, result: "ä½ çˆ±ä¸Šäº†é˜…è¯»ã€‚" },
            { text: "ä½“è‚²è¯¾", effect: { health: 15, skill: "è¿åŠ¨" }, result: "ä½ è¿åŠ¨èƒ½åŠ›å¾ˆå¼ºï¼" },
            { text: "éŸ³ä¹è¯¾", effect: { charm: 10, skill: "éŸ³ä¹" }, result: "ä½ å¯¹éŸ³ä¹å¾ˆæœ‰å…´è¶£ã€‚" }
        ]
    }
};

// é»˜è®¤äº‹ä»¶ç”Ÿæˆå™¨
function getDefaultEvent(age) {
    return {
        npc: ["æœ‹å‹", "åŒäº‹", "å®¶äºº"][age % 3],
        scene: ["ğŸ¢", "ğŸ ", "ğŸŒ³"][age % 3],
        avatar: "ğŸ‘¤",
        dialogue: "ä»Šå¹´ä½ " + age + "å²äº†ï¼Œç”Ÿæ´»ä¸­é‡åˆ°äº†ä¸€ä¸ªæ–°çš„é€‰æ‹©...",
        choices: [
            { text: "åŠªåŠ›å·¥ä½œ", effect: { money: 8000, career: 1, health: -2 }, result: "ä½ åŠªåŠ›å·¥ä½œï¼Œæ”¶å…¥å¢åŠ äº†ã€‚" },
            { text: "é™ªä¼´å®¶äºº", effect: { health: 10, relationship: 10 }, result: "ä½ å’Œå®¶äººåœ¨ä¸€èµ·çš„æ—¶å…‰å¾ˆå¹¸ç¦ã€‚" },
            { text: "æŠ•èµ„ç†è´¢", effect: { money: Math.floor(Math.random() * 20000 - 5000), skill: "æŠ•èµ„" }, result: "æŠ•èµ„æ”¶ç›Šæœ‰ç›ˆäºã€‚" },
            { text: "å­¦ä¹ æ–°çŸ¥è¯†", effect: { intelligence: 10, skill: "æŠ€èƒ½" }, result: "ä½ å­¦ä¼šäº†æ–°æŠ€èƒ½ï¼" }
        ]
    };
}

// è·å–å½“å‰äº‹ä»¶
function getCurrentEvent() {
    return events[gameState.age] || getDefaultEvent(gameState.age);
}

// è·å–æœ‰æ•ˆé€‰é¡¹
function getValidChoices(evt) {
    if (!evt || !evt.choices) return [];
    var valid = [];
    for (var i = 0; i < evt.choices.length; i++) {
        var c = evt.choices[i];
        if (!c.condition) {
            valid.push(c);
        } else {
            try {
                if (c.condition()) {
                    valid.push(c);
                }
            } catch(e) {
                valid.push(c);
            }
        }
    }
    return valid;
}

// åº”ç”¨æ•ˆæœ
function applyEffect(effect) {
    if (!effect) return;
    if (effect.money) gameState.money += effect.money;
    if (effect.health) gameState.health += effect.health;
    if (effect.intelligence) gameState.intelligence += effect.intelligence;
    if (effect.charm) gameState.charm += effect.charm;
    if (effect.luck) gameState.luck += effect.luck;
    if (effect.fame) gameState.fame += effect.fame;
    if (effect.career) gameState.careerLevel += effect.career;
    if (effect.relationship) gameState.relationship += effect.relationship;
    if (effect.job) gameState.job = effect.job;
    if (effect.skill && gameState.skills.indexOf(effect.skill) === -1) {
        gameState.skills.push(effect.skill);
    }
    gameState.health = Math.max(0, Math.min(100, gameState.health));
    gameState.intelligence = Math.max(0, Math.min(100, gameState.intelligence));
    gameState.charm = Math.max(0, Math.min(100, gameState.charm));
    gameState.luck = Math.max(0, Math.min(100, gameState.luck));
}

// æ£€æŸ¥æ¸¸æˆç»“æŸ
function checkGameOver() {
    if (gameState.health <= 0) {
        alert('ğŸ’€ æ¸¸æˆç»“æŸï¼å¥åº·è€—å°½');
        return true;
    }
    if (gameState.money < -50000) {
        alert('ğŸ’¸ æ¸¸æˆç»“æŸï¼è´Ÿå€ºè¿‡å¤š');
        return true;
    }
    return false;
}

// é€‰æ‹©é€‰é¡¹
function makeChoice(index) {
    var evt = getCurrentEvent();
    var validChoices = getValidChoices(evt);
    
    if (index >= validChoices.length || index < 0) {
        alert('é€‰é¡¹æ— æ•ˆï¼');
        return;
    }
    
    var choice = validChoices[index];
    applyEffect(choice.effect);
    gameState.events.push({ age: gameState.age, event: choice.text });
    
    if (checkGameOver()) return;
    
    gameState.age++;
    
    if (gameState.age > 65) {
        alert('ğŸ® æ¸¸æˆç»“æŸï¼æ­å–œé€šå…³ï¼');
        return;
    }
    
    showResult(choice.result);
}

// æ˜¾ç¤ºç»“æœ
function showResult(text) {
    var panel = document.getElementById('choicesPanel');
    panel.innerHTML = '<div class="result-box">ğŸ“ æ”¶è·: ' + text + '</div>' +
        '<button class="choice-btn" onclick="updateUI()" style="background:#00ff88;color:#000;font-weight:bold">è¿›å…¥ä¸‹ä¸€å¹´</button>' +
        '<div class="free-input"><input type="text" id="freeInput" placeholder="è¾“å…¥ä½ çš„æƒ³æ³•"><button onclick="submitFreeChoice()">æäº¤</button></div>';
}

// æäº¤è‡ªç”±è¾“å…¥
function submitFreeChoice() {
    var input = document.getElementById('freeInput');
    if (!input) return;
    
    var text = input.value.trim();
    if (!text) {
        alert('è¯·è¾“å…¥ä½ çš„æƒ³æ³•ï¼');
        return;
    }
    
    var choices = generateAIChoice(text);
    var choice = choices[0];
    
    applyEffect(choice.effect);
    gameState.events.push({ age: gameState.age, event: text });
    
    if (checkGameOver()) return;
    
    gameState.age++;
    
    if (gameState.age > 65) {
        alert('ğŸ® æ¸¸æˆç»“æŸï¼æ­å–œé€šå…³ï¼');
        return;
    }
    
    showResult(choice.result);
}

// AIç”Ÿæˆé€‰æ‹©
function generateAIChoice(input) {
    var l = input.toLowerCase();
    var effect = {}, result = "";
    if (l.indexOf('å·¥ä½œ') !== -1) { effect = { money: 5000 + gameState.careerLevel * 1000, career: 1 }; result = "ä½ æ‰¾åˆ°äº†å·¥ä½œã€‚"; }
    else if (l.indexOf('å­¦ä¹ ') !== -1) { effect = { intelligence: 10, money: -2000 }; result = "ä½ åŠªåŠ›å­¦ä¹ ã€‚"; }
    else if (l.indexOf('åˆ›ä¸š') !== -1) { effect = { money: 10000, fame: 10 }; result = "ä½ å¼€å§‹åˆ›ä¸šã€‚"; }
    else if (l.indexOf('æ—…è¡Œ') !== -1) { effect = { charm: 10, money: -5000, health: 5 }; result = "ä½ å‡ºå»æ—…è¡Œäº†ï¼"; }
    else if (l.indexOf('å¥èº«') !== -1 || l.indexOf('è¿åŠ¨') !== -1) { effect = { health: 15 }; result = "ä½ é”»ç‚¼èº«ä½“ï¼"; }
    else if (l.indexOf('ç¤¾äº¤') !== -1 || l.indexOf('è®¤è¯†') !== -1) { effect = { charm: 10, fame: 5 }; result = "è®¤è¯†äº†æ–°æœ‹å‹ã€‚"; }
    else if (l.indexOf('æŠ•èµ„') !== -1 || l.indexOf('ç†è´¢') !== -1) { var g = Math.floor(Math.random() * 20000); effect = { money: g }; result = g > 0 ? "èµšäº†" + g + "å…ƒï¼" : "æœ‰äºæŸã€‚"; }
    else { effect = { money: 2000, health: 5 }; result = "åº¦è¿‡äº†å……å®çš„ä¸€å¹´ã€‚"; }
    return [{ text: input, effect: effect, result: result }];
}

// æ›´æ–°UI
function updateUI() {
    document.getElementById('yearDisplay').textContent = 'ç¬¬ ' + gameState.age + ' å¹´';
    document.getElementById('health').textContent = gameState.health;
    document.getElementById('money').textContent = 'Â¥' + gameState.money;
    document.getElementById('intelligence').textContent = gameState.intelligence;
    document.getElementById('charm').textContent = gameState.charm;
    document.getElementById('luck').textContent = gameState.luck;
    document.getElementById('fame').textContent = gameState.fame;
    
    var avatars = ["ğŸ‘¶", "ğŸ‘§", "ğŸ‘¦", "ğŸ§‘", "ğŸ‘±", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨"];
    var names = ["å©´å„¿", "å¹¼å„¿", "å„¿ç«¥", "å°‘å¹´", "é’å¹´", "æˆäºº", "æˆäºº", "æˆäºº", "ä¸­å¹´äºº", "è€å¹´äºº"];
    document.getElementById('avatar').textContent = avatars[Math.min(Math.floor(gameState.age / 5), avatars.length - 1)];
    document.getElementById('charName').textContent = names[Math.min(Math.floor(gameState.age / 10), names.length - 1)];
    document.getElementById('charInfo').textContent = gameState.age + 'å² ' + gameState.job;
    
    document.getElementById('skillsList').innerHTML = gameState.skills.length ? 
        gameState.skills.map(function(s) { return '<span class="skill-tag">' + s + '</span>'; }).join('') : 
        '<span class="skill-tag">æ— </span>';
    
    document.getElementById('eventLog').innerHTML = gameState.events.slice(-5).map(function(e) {
        return '<div>ğŸŒŸ ' + e.age + 'å² - ' + e.event + '</div>';
    }).join('');
    
    var evt = getCurrentEvent();
    document.getElementById('sceneImage').textContent = evt.scene;
    document.getElementById('npcAvatar').textContent = evt.avatar;
    document.getElementById('npcName').textContent = evt.npc;
    document.getElementById('dialogueText').textContent = evt.dialogue;
    
    var valid = getValidChoices(evt);
    document.getElementById('choicesList').innerHTML = valid.map(function(c, i) {
        return '<button class="choice-btn" onclick="makeChoice(' + i + ')">' + c.text + '</button>';
    }).join('');
}

// åˆå§‹åŒ–
document.getElementById('submitBtn').onclick = function() { submitFreeChoice(); };
updateUI();