<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ğŸ® AIäººç”Ÿæ¨¡æ‹Ÿå™¨ - çœŸå®ç‰ˆ</title>
<style>
body{font-family:'Microsoft YaHei';background:#1a1a2e;color:#fff;padding:20px;margin:0;min-height:100vh}
.game-container{max-width:900px;margin:0 auto}
.year-display{text-align:center;font-size:28px;color:#ffd700;margin-bottom:10px}
.age-phase{text-align:center;font-size:14px;color:#00ff88;margin-bottom:15px}
.goal-box{text-align:center;background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,204,255,0.1));padding:10px;border-radius:10px;margin-bottom:15px;border:1px solid rgba(0,255,136,0.3)}
.goal-label{font-size:12px;color:#00ff88}
.goal-text{font-size:14px;color:#fff}
.fortune-box{text-align:center;background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,165,0,0.2));padding:8px;border-radius:10px;margin-bottom:15px;border:1px solid rgba(255,215,0,0.3)}
.fortune-label{font-size:12px;color:#ffd700}
.fortune-text{font-size:13px;color:#fff}
.status-bar{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-bottom:15px}
.stat-item{background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;text-align:center}
.stat-label{font-size:10px;color:#888;margin-bottom:4px}
.stat-value{font-size:16px;font-weight:bold}
.stat-bar{height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-top:4px;overflow:hidden}
.stat-fill{height:100%;border-radius:2px;transition:width 0.3s}
.main-area{display:grid;grid-template-columns:200px 1fr;gap:20px}
@media(max-width:700px){.main-area{grid-template-columns:1fr}.status-bar{grid-template-columns:repeat(3,1fr)}}
.avatar{font-size:50px;text-align:center;margin-bottom:10px}
.char-name{text-align:center;font-size:18px;margin-bottom:5px}
.char-info{text-align:center;color:#888;font-size:12px}
.skills-list{display:flex;flex-wrap:wrap;gap:5px;margin-top:10px}
.skill-tag{background:rgba(255,255,255,0.1);padding:3px 8px;border-radius:10px;font-size:11px}
.event-log{font-size:11px;max-height:150px;overflow-y:auto;margin-top:10px}
.story-panel{background:rgba(0,0,0,0.3);padding:15px;border-radius:10px;flex:1}
.scene-image{font-size:40px;text-align:center;margin-bottom:10px}
.npc-area{display:flex;gap:10px;margin-bottom:10px;align-items:flex-start}
.npc-avatar{font-size:30px;position:relative;cursor:pointer}
.speak-btn{position:absolute;bottom:-5px;right:-5px;font-size:12px;background:#00ff88;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center}
.dialogue-box{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px;flex:1}
.npc-name{color:#ffd700;font-size:12px;margin-bottom:5px}
.choices-title{font-size:14px;color:#00ccff;margin:10px 0}
.choice-btn{display:block;width:100%;padding:12px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff;text-align:left;margin-bottom:8px;cursor:pointer;transition:all 0.2s}
.choice-btn:hover{background:rgba(0,255,136,0.2);border-color:#00ff88;transform:translateX(5px)}
.choice-desc{font-size:11px;color:#888;margin-top:3px}
.free-input{margin-top:15px}
.free-input input{width:100%;padding:10px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff}
.free-input button{margin-top:8px;padding:10px 20px;background:#00ff88;border:none;border-radius:8px;color:#000;font-weight:bold;cursor:pointer}
</style>
</head>
<body>
<div class="game-container">
<div class="year-display" id="yearDisplay">ğŸ‚ ç¬¬ 0 å¹´</div>
<div class="age-phase" id="agePhase">ğŸ‘¶ å©´å„¿æœŸ</div>

<div class="goal-box" id="goalBox">
<div class="goal-label">ğŸ¯ äººç”Ÿç›®æ ‡</div>
<div class="goal-text" id="goalText">éšæœºç”Ÿæˆä¸­...</div>
</div>

<div class="fortune-box" id="fortuneBox">
<div class="fortune-label">ğŸ”® ä»Šå¹´è¿åŠ¿</div>
<div class="fortune-text" id="fortuneText">ç‚¹å‡»æŸ¥çœ‹ä»Šæ—¥è¿åŠ¿</div>
</div>

<div class="status-bar">
<div class="stat-item"><div class="stat-label">â¤ï¸ å¥åº·</div><div class="stat-value" id="health">100</div><div class="stat-bar"><div class="stat-fill" id="healthBar" style="width:100%;background:#00ff88"></div></div></div>
<div class="stat-item"><div class="stat-label">ğŸ’° é‡‘é’±</div><div class="stat-value" id="money">Â¥0</div></div>
<div class="stat-item"><div class="stat-label">ğŸ§  æ™ºåŠ›</div><div class="stat-value" id="intelligence">50</div><div class="stat-bar"><div class="stat-fill" id="intBar" style="width:50%;background:#00ccff"></div></div></div>
<div class="stat-item"><div class="stat-label">âœ¨ é­…åŠ›</div><div class="stat-value" id="charm">50</div><div class="stat-bar"><div class="stat-fill" id="charmBar" style="width:50%;background:#ff6b6b"></div></div></div>
<div class="stat-item"><div class="stat-label">ğŸ€ å¹¸è¿</div><div class="stat-value" id="luck">50</div><div class="stat-bar"><div class="stat-fill" id="luckBar" style="width:50%;background:#ffd700"></div></div></div>
<div class="stat-item"><div class="stat-label">â­ å£°æœ›</div><div class="stat-value" id="fame">0</div></div>
</div>

<div class="main-area">
<div class="left-panel">
<div class="avatar" id="avatar">ğŸ‘¶</div>
<div class="char-name" id="charName">å©´å„¿</div>
<div class="char-info" id="charInfo">0å²</div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">ğŸ¯ æŠ€èƒ½</div><div class="skills-list" id="skillsList"><span class="skill-tag">æ— </span></div></div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">ğŸ“œ ç»å†</div><div class="event-log" id="eventLog"><div>ğŸŒŸ ä½ å‡ºç”Ÿäº†</div></div></div>
</div>
<div class="center-area">
<div class="story-panel">
<div class="scene-image" id="sceneImage">ğŸ¥</div>
<div class="npc-area">
<div class="npc-avatar" id="npcAvatar" onclick="speakText()">ğŸ‘©<div class="speak-btn">ğŸ”Š</div></div>
<div class="dialogue-box">
<div class="npc-name" id="npcName">å¦ˆå¦ˆ</div>
<div id="dialogueText">å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼</div>
</div>
</div>
</div>
<div class="choices-panel" id="choicesPanel">
<div class="choices-title">âœ¨ ä½ å†³å®šï¼š</div>
<div id="choicesList"></div>
<div class="free-input"><input type="text" id="freeInput" placeholder="ğŸ’¬ è¾“å…¥ä½ çš„æƒ³æ³•"><button id="submitBtn">æäº¤</button></div>
</div>
</div>
</div>
</div>

<script>
// æ¸¸æˆçŠ¶æ€
var gameState = {
    age: 0,
    health: 100,
    money: 0,
    intelligence: 50,
    charm: 50,
    luck: 50,
    fame: 0,
    skills: [],
    events: [],
    job: "å©´å„¿",
    relationship: 0,
    careerLevel: 0,
    education: 0,
    goal: "",
    fortune: ""
};

// äººç”Ÿç›®æ ‡
var goals = ["æˆä¸ºäº¿ä¸‡å¯Œç¿ ğŸ¤‘", "æ‰¾åˆ°çœŸçˆ± ğŸ’•", "ç¯æ¸¸ä¸–ç•Œ ğŸŒ", "æ”¹å˜ä¸–ç•Œ ğŸŒ", "æˆä¸ºè¡Œä¸šç²¾è‹± ğŸ’¼", "æ‹¥æœ‰å¹¸ç¦å®¶åº­ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§", "æ´»åˆ°100å² ğŸ‚", "æˆä¸ºçŸ¥åäººç‰© â­", "å¸®åŠ©ä»–äºº ğŸ™Œ", "å®ç°è´¢åŠ¡è‡ªç”± ğŸ’°", "æ‹¥æœ‰è‡ªå·±çš„å…¬å¸ ğŸ¢", "æˆä¸ºè‰ºæœ¯å®¶ ğŸ¨"];

// è¿åŠ¿
var fortunes = ["ä»Šå¹´äº‹ä¸šè¿åŠ¿ä¸é”™ï¼Œé€‚åˆæ‹¼æ ğŸ’ª", "å¥åº·è¿åŠ¿ä¸‹æ»‘ï¼Œæ³¨æ„èº«ä½“ âš ï¸", "è´¢è¿äº¨é€šï¼Œé€‚åˆæŠ•èµ„ ğŸ’°", "äººé™…å…³ç³»æ´»è·ƒï¼Œå¤šäº¤æœ‹å‹ ğŸ¤", "å­¦ä¹ è¿åŠ¿æ—ºç››ï¼Œè¿›ä¿®å¥½æ—¶æœº ğŸ“š", "çˆ±æƒ…è¿åŠ¿æ¥ä¸´ï¼ŒæŠŠæ¡æœºä¼š ğŸ’•", "æ•´ä½“å¹³ç¨³ï¼Œé¡ºå…¶è‡ªç„¶ ğŸŒŠ", "æŒ‘æˆ˜ä¸æœºé‡å¹¶å­˜ï¼Œå‹‡æ•¢å‰è¡Œ ğŸš€", "é€‚åˆä¼‘æ¯è°ƒæ•´ï¼Œæ”¾æ…¢è„šæ­¥ ğŸ§˜", "åˆ›é€ åŠ›çˆ†å‘ï¼Œé€‚åˆåˆ›ä½œ ğŸ¨"];

// å¹´é¾„é˜¶æ®µå®šä¹‰
function getAgePhase(age) {
    if (age < 3) return { name: "ğŸ‘¶ å©´å„¿æœŸ", npc: "å¦ˆå¦ˆ", scene: "ğŸ¥", avatar: "ğŸ‘©" };
    if (age < 6) return { name: "ğŸ§’ å¹¼å„¿æœŸ", npc: "çˆ¸çˆ¸", scene: "ğŸ ", avatar: "ğŸ‘¨" };
    if (age < 12) return { name: "ğŸ« å°å­¦æœŸ", npc: "è€å¸ˆ", scene: "ğŸ«", avatar: "ğŸ‘¨â€ğŸ«" };
    if (age < 18) return { name: "ğŸ“š ä¸­å­¦æœŸ", npc: "ç­ä¸»ä»»", scene: "ğŸ«", avatar: "ğŸ‘©â€ğŸ«" };
    if (age < 22) return { name: "ğŸ“ å¤§å­¦æœŸ", npc: "å­¦é•¿", scene: "ğŸ«", avatar: "ğŸ‘¨â€ğŸ“" };
    if (age < 30) return { name: "ğŸ’¼ åˆèŒæœŸ", npc: "ä¸Šå¸", scene: "ğŸ¢", avatar: "ğŸ‘¨â€ğŸ’¼" };
    if (age < 45) return { name: "ğŸ¢ èŒä¸šæœŸ", npc: "åŒäº‹", scene: "ğŸ¢", avatar: "ğŸ‘”" };
    if (age < 60) return { name: "ğŸ‘” ä¸­å¹´æœŸ", npc: "æœ‹å‹", scene: "ğŸ ", avatar: "ğŸ‘«" };
    return { name: "ğŸ‘´ è€å¹´æœŸ", npc: "å­å¥³", scene: "ğŸ ", avatar: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§" };
}

// æ ¹æ®å¹´é¾„è·å–é€‰é¡¹
function getChoicesByAge() {
    var age = gameState.age;
    var phase = getAgePhase(age);
    
    // å©´å„¿æœŸ 0-2å²
    if (age < 3) {
        return [
            { text: "ğŸ˜Š å¥åº·æˆé•¿", effect: { health: 15 }, result: "ä½ å¥åº·æˆé•¿ç€ï¼Œå°èº«ä½“æ£’æ£’çš„ï¼", desc: "å¥åº·+15" },
            { text: "ğŸ˜¢ å“­é—¹è¡¨è¾¾", effect: { charm: 5 }, result: "ä½ ç”¨å“­é—¹æ¥è¡¨è¾¾éœ€æ±‚ã€‚", desc: "é­…åŠ›+5" },
            { text: "ğŸ˜´ å®‰é™ç¡è§‰", effect: { health: 10 }, result: "ä½ å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç¡è§‰ï¼Œé•¿èº«ä½“ã€‚", desc: "å¥åº·+10" },
            { text: "ğŸ‘€ å¥½å¥‡è§‚å¯Ÿ", effect: { intelligence: 10 }, result: "ä½ å¥½å¥‡åœ°è§‚å¯Ÿç€è¿™ä¸ªæ–°å¥‡çš„ä¸–ç•Œã€‚", desc: "æ™ºåŠ›+10" }
        ];
    }
    
    // å¹¼å„¿æœŸ 3-5å²
    if (age < 6) {
        return [
            { text: "ğŸš— ç©ç©å…·è½¦", effect: { intelligence: 10, skill: "æœºæ¢°å…´è¶£" }, result: "ä½ å¯¹æœºæ¢°ç©å…·çˆ±ä¸é‡Šæ‰‹ï¼", desc: "æ™ºåŠ›+10, è·å¾—æŠ€èƒ½" },
            { text: "ğŸ¨ ç”»ç”»", effect: { intelligence: 5, skill: "ç»˜ç”»å…´è¶£" }, result: "ä½ æœ€å–œæ¬¢æ¶‚æ¶‚ç”»ç”»ã€‚", desc: "æ™ºåŠ›+5, è·å¾—æŠ€èƒ½" },
            { text: "ğŸ‘« äº¤å°æœ‹å‹", effect: { charm: 15, skill: "ç¤¾äº¤" }, result: "ä½ äº¤åˆ°äº†ç¬¬ä¸€ä¸ªå¥½æœ‹å‹ï¼", desc: "é­…åŠ›+15, è·å¾—æŠ€èƒ½" },
            { text: "ğŸ“– å¬æ•…äº‹", effect: { intelligence: 10 }, result: "ä½ æ²‰æµ¸åœ¨ç²¾å½©çš„æ•…äº‹ä¸­ã€‚", desc: "æ™ºåŠ›+10" }
        ];
    }
    
    // å°å­¦æœŸ 6-11å²
    if (age < 12) {
        var choices = [
            { text: "ğŸ“ å­¦æ•°å­¦", effect: { intelligence: 15, skill: "æ•°å­¦" }, result: "ä½ å±•ç°äº†æ•°å­¦å¤©èµ‹ï¼", desc: "æ™ºåŠ›+15" },
            { text: "ğŸ“š è¯»è¯¾å¤–ä¹¦", effect: { intelligence: 10, skill: "é˜…è¯»" }, result: "ä½ è¯»äº†å¾ˆå¤šæœ‰è¶£çš„è¯¾å¤–ä¹¦ã€‚", desc: "æ™ºåŠ›+10" },
            { text: "âš½ è¸¢è¶³çƒ", effect: { health: 15, skill: "è¶³çƒ" }, result: "ä½ æˆäº†ç­è¶³çƒé˜Ÿä¸»åŠ›ï¼", desc: "å¥åº·+15" },
            { text: "ğŸµ å­¦é’¢ç´", effect: { charm: 10, skill: "é’¢ç´", money: -3000 }, result: "ä½ å­¦ä¼šäº†å¼¹é’¢ç´ï¼", desc: "é­…åŠ›+10, èŠ±è´¹Â¥3000" }
        ];
        // æœ‰é’±çš„è¯å¯ä»¥ä¸Šè¡¥ä¹ ç­
        if (gameState.money >= 2000) {
            choices.push({ text: "ğŸ“š ä¸Šè¡¥ä¹ ç­", effect: { intelligence: 10, money: -2000 }, result: "ä½ å‚åŠ äº†å¥¥æ•°ç­ã€‚", desc: "æ™ºåŠ›+10, èŠ±è´¹Â¥2000" });
        }
        return choices;
    }
    
    // ä¸­å­¦æœŸ 12-17å²
    if (age < 18) {
        var choices = [
            { text: "ğŸ“– åŠªåŠ›å­¦ä¹ ", effect: { intelligence: 15, education: 1 }, result: "ä½ æˆç»©ä¼˜å¼‚ï¼Œæ˜¯è€å¸ˆçœ¼ä¸­çš„å¥½å­¦ç”Ÿï¼", desc: "æ™ºåŠ›+15, æ•™è‚²+1" },
            { text: "ğŸ€ æ‰“ç¯®çƒ", effect: { health: 15, charm: 10, skill: "ç¯®çƒ" }, result: "ä½ æˆäº†ç¯®çƒé˜Ÿé•¿ï¼", desc: "å¥åº·+15, é­…åŠ›+10" },
            { text: "ğŸ’• è°ˆæ‹çˆ±", effect: { relationship: 20, charm: 10 }, result: "ä½ å¼€å§‹äº†ç¬¬ä¸€æ®µç¾å¥½çš„æ‹æƒ…ã€‚", desc: "å…³ç³»+20, é­…åŠ›+10" },
            { text: "ğŸ® ç©æ¸¸æˆ", effect: { charm: 5, intelligence: -5 }, result: "ä½ æ²‰è¿·æ¸¸æˆï¼Œæˆç»©ä¸‹æ»‘äº†ã€‚", desc: "é­…åŠ›+5, æ™ºåŠ›-5" }
        ];
        if (gameState.intelligence >= 60) {
            choices.push({ text: "ğŸ† å‚åŠ ç«èµ›", effect: { fame: 15, intelligence: 10 }, result: "ä½ è·å¾—äº†ç«èµ›å¥–é¡¹ï¼", desc: "å£°æœ›+15, æ™ºåŠ›+10" });
        }
        return choices;
    }
    
    // å¤§å­¦æœŸ 18-21å²
    if (age < 22) {
        var choices = [
            { text: "ğŸ“š è€ƒç ”æ·±é€ ", effect: { intelligence: 15, money: -5000, education: 2 }, result: "ä½ å†³å®šç»§ç»­æ·±é€ è€ƒç ”ï¼", desc: "æ™ºåŠ›+15, æ•™è‚²+2" },
            { text: "ğŸ’¼ æ‰¾å®ä¹ ", effect: { money: 3000, skill: "å·¥ä½œç»éªŒ", career: 1 }, result: "ä½ æ‰¾åˆ°äº†å®ä¹ å·¥ä½œã€‚", desc: "é‡‘é’±+3000, ç»éªŒ+1" },
            { text: "ğŸ­ å‚åŠ ç¤¾å›¢", effect: { charm: 15, skill: "ç¤¾äº¤" }, result: "ä½ è®¤è¯†äº†éå¸¸å¤šæ–°æœ‹å‹ï¼", desc: "é­…åŠ›+15" },
            { text: "ğŸ® æ‰“æ¸¸æˆ", effect: { charm: 10 }, result: "ä½ äº«å—ç€å¤§å­¦ç”Ÿæ´»ã€‚", desc: "é­…åŠ›+10" }
        ];
        if (gameState.intelligence >= 70) {
            choices.push({ text: "ğŸš€ åˆ›ä¸š", effect: { money: -10000, fame: 20, skill: "åˆ›ä¸šç»éªŒ" }, result: "ä½ å’ŒåŒå­¦ä¸€èµ·åˆ›ä¸šäº†ï¼", desc: "å£°æœ›+20, é£é™©å¤§" });
        }
        return choices;
    }
    
    // åˆèŒæœŸ 22-29å²
    if (age < 30) {
        var choices = [
            { text: "ğŸ’ª æ‹¼å‘½å·¥ä½œ", effect: { money: 15000, career: 2, health: -10 }, result: "ä½ æ‹¼å‘½å·¥ä½œï¼Œä¸šç»©çªå‡ºï¼", desc: "é‡‘é’±+15000, èŒçº§+2, å¥åº·-10" },
            { text: "ğŸ’• æ‰¾å¯¹è±¡", effect: { relationship: 25, charm: 10 }, result: "ä½ æ‰¾åˆ°äº†å¿ƒä»ªçš„å¦ä¸€åŠï¼", desc: "å…³ç³»+25, é­…åŠ›+10" },
            { text: "ğŸ“š ç»§ç»­å­¦ä¹ ", effect: { intelligence: 10, money: -5000, skill: "ä¸“ä¸šæŠ€èƒ½" }, result: "ä½ è€ƒå–äº†ä¸“ä¸šèµ„æ ¼è¯ä¹¦ï¼", desc: "æ™ºåŠ›+10, æŠ€èƒ½" },
            { text: "ğŸŒ´ äº«å—ç”Ÿæ´»", effect: { health: 10, money: -5000 }, result: "ä½ å¥½å¥½äº«å—ç”Ÿæ´»ã€‚", desc: "å¥åº·+10, èŠ±è´¹-5000" }
        ];
        if (gameState.careerLevel >= 5) {
            choices.push({ text: "ğŸ¢ å‡èŒåŠ è–ª", effect: { money: 30000, fame: 20, career: 3 }, result: "ä½ æˆåŠŸå‡èŒäº†ï¼", desc: "é‡‘é’±+30000, å£°æœ›+20" });
        }
        return choices;
    }
    
    // èŒä¸šæœŸ 30-44å²
    if (age < 45) {
        var choices = [
            { text: "ğŸ’¼ ä¸“æ³¨äº‹ä¸š", effect: { money: 25000, career: 2, health: -5 }, result: "ä½ ä¸“æ³¨äºäº‹ä¸šå‘å±•ã€‚", desc: "é‡‘é’±+25000, èŒçº§+2" },
            { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç»“å©šç”Ÿå­", effect: { relationship: 30, money: -30000, health: -5 }, result: "ä½ ç»„æˆäº†å¹¸ç¦å®¶åº­ï¼", desc: "å…³ç³»+30, èŠ±è´¹å¤§" },
            { text: "ğŸ“ˆ æŠ•èµ„ç†è´¢", effect: { money: Math.floor(Math.random() * 30000 - 5000), skill: "æŠ•èµ„" }, result: "æŠ•èµ„æ”¶ç›Šä¸ç¡®å®šã€‚", desc: "æœ‰é£é™©" },
            { text: "ğŸƒ é”»ç‚¼èº«ä½“", effect: { health: 20 }, result: "ä½ åšæŒé”»ç‚¼ï¼Œèº«ä½“æ£’æ£’çš„ï¼", desc: "å¥åº·+20" }
        ];
        if (gameState.money >= 100000) {
            choices.push({ text: "ğŸ¢ åˆ›ä¸šå½“è€æ¿", effect: { money: -50000, fame: 30, skill: "åˆ›ä¸š" }, result: "ä½ åˆ›åŠäº†è‡ªå·±çš„å…¬å¸ï¼", desc: "å£°æœ›+30, é«˜é£é™©é«˜å›æŠ¥" });
        }
        return choices;
    }
    
    // ä¸­å¹´æœŸ 45-59å²
    if (age < 60) {
        return [
            { text: "ğŸ’¼ ç¨³å®šå·¥ä½œ", effect: { money: 20000, health: -5 }, result: "ä½ å·¥ä½œç¨³å®šã€‚", desc: "é‡‘é’±+20000, å¥åº·-5" },
            { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç…§é¡¾å®¶åº­", effect: { relationship: 20, health: 10 }, result: "ä½ äº«å—å¤©ä¼¦ä¹‹ä¹ã€‚", desc: "å…³ç³»+20, å¥åº·+10" },
            { text: "ğŸ“š ç»§ç»­å­¦ä¹ ", effect: { intelligence: 10, skill: "æ–°æŠ€èƒ½" }, result: "ä½ å­¦ä¹ æ–°æŠ€èƒ½ã€‚", desc: "æ™ºåŠ›+10" },
            { text: "ğŸƒ å…»ç”Ÿä¿å¥", effect: { health: 25 }, result: "ä½ æ³¨é‡å…»ç”Ÿã€‚", desc: "å¥åº·+25" }
        ];
    }
    
    // è€å¹´æœŸ 60å²+
    return [
        { text: "âœï¸ å†™å›å¿†å½•", effect: { fame: 20, intelligence: 10 }, result: "ä½ å¼€å§‹å†™å›å¿†å½•ã€‚", desc: "å£°æœ›+20" },
        { text: "ğŸ‘¶ å«é¥´å¼„å­™", effect: { health: 15, relationship: 20 }, result: "ä½ äº«å—å¤©ä¼¦ä¹‹ä¹ï¼", desc: "å¥åº·+15, å…³ç³»+20" },
        { text: "ğŸŒ å‘¨æ¸¸ä¸–ç•Œ", effect: { money: -50000, charm: 20 }, result: "ä½ å»å‘¨æ¸¸ä¸–ç•Œï¼", desc: "èŠ±è´¹å¤§, é­…åŠ›+20" },
        { text: "ğŸŒ± ç§èŠ±å…»è‰", effect: { health: 20 }, result: "ä½ è¿‡èµ·æ‚ é—²çš„é€€ä¼‘ç”Ÿæ´»ã€‚", desc: "å¥åº·+20" }
    ];
}

// è·å–å½“å‰äº‹ä»¶
function getCurrentEvent() {
    var phase = getAgePhase(gameState.age);
    return {
        npc: phase.npc,
        scene: phase.scene,
        avatar: phase.avatar,
        dialogue: getDialogue(gameState.age),
        choices: getChoicesByAge()
    };
}

function getDialogue(age) {
    var dialogues = {
        0: "å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼",
        1: "1å²äº†ï¼Œä¼šèµ°è·¯äº†å—ï¼Ÿ",
        2: "2å²äº†ï¼Œå¼€å§‹å­¦è¯´è¯äº†ã€‚",
        3: "3å²äº†ï¼Œè©²ä¸Šå¹¼å„¿å›­äº†ã€‚",
        5: "5å²äº†ï¼Œé©¬ä¸Šè¦ä¸Šå°å­¦äº†ã€‚",
        6: "ä¸Šå°å­¦äº†ï¼Œè¦å¼€å§‹å­¦ä¹ äº†ï¼",
        12: "ä¸Šåˆä¸­äº†ï¼Œè¿›å…¥é’æ˜¥æœŸäº†ã€‚",
        15: "é«˜ä¸­äº†ï¼Œè¦è€ƒå¤§å­¦äº†ï¼",
        18: "18å²äº†ï¼Œæˆå¹´äº†ï¼Œè¦åšå†³å®šäº†ã€‚",
        22: "å¤§å­¦æ¯•ä¸šäº†ï¼Œè¦å¼€å§‹å·¥ä½œäº†ã€‚",
        30: "30è€Œç«‹ä¹‹å¹´ï¼Œå®¶åº­äº‹ä¸šéƒ½è¦å…¼é¡¾ã€‚",
        40: "40ä¸æƒ‘ä¹‹å¹´ï¼Œäººç”Ÿè¿‡äº†å¤§åŠäº†ã€‚",
        50: "50çŸ¥å¤©å‘½ï¼Œè¯¥é€€ä¼‘äº†ã€‚",
        60: "60èŠ±ç”²ï¼Œè¯¥äº«å—ç”Ÿæ´»äº†ã€‚"
    };
    for (var i = age; i >= 0; i--) {
        if (dialogues[i]) return dialogues[i];
    }
    return "ä»Šå¹´ä½ " + age + "å²äº†...";
}

function generateGoal() {
    gameState.goal = goals[Math.floor(Math.random() * goals.length)];
    document.getElementById('goalText').textContent = gameState.goal;
}

function generateFortune() {
    gameState.fortune = fortunes[Math.floor(Math.random() * fortunes.length)];
    document.getElementById('fortuneText').textContent = gameState.fame > 50 ? "â­ é¸¿è¿å½“å¤´ï¼" : gameState.fortune;
}

function speakText() {
    var text = document.getElementById('dialogueText').textContent;
    var utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'zh-CN';
    speechSynthesis.speak(utterance);
}

function applyEffect(effect) {
    if (!effect) return;
    if (effect.money) gameState.money += effect.money;
    if (effect.health) gameState.health += effect.health;
    if (effect.intelligence) gameState.intelligence += effect.intelligence;
    if (effect.charm) gameState.charm += effect.charm;
    if (effect.luck) gameState.luck += effect.luck;
    if (effect.fame) gameState.fame += effect.fame;
    if (effect.career) gameState.careerLevel += effect.career;
    if (effect.relationship) gameState.relationship += effect.relationship;
    if (effect.education) gameState.education += effect.education;
    if (effect.job) gameState.job = effect.job;
    if (effect.skill && gameState.skills.indexOf(effect.skill) === -1) gameState.skills.push(effect.skill);
    gameState.health = Math.max(0, Math.min(100, gameState.health));
    gameState.intelligence = Math.max(0, Math.min(100, gameState.intelligence));
    gameState.charm = Math.max(0, Math.min(100, gameState.charm));
    gameState.luck = Math.max(0, Math.min(100, gameState.luck));
}

function checkGameOver() {
    if (gameState.health <= 0) { alert('ğŸ’€ æ¸¸æˆç»“æŸï¼å¥åº·è€—å°½'); return true; }
    if (gameState.money < -100000) { alert('ğŸ’¸ æ¸¸æˆç»“æŸï¼è´Ÿå€ºè¿‡å¤š'); return true; }
    return false;
}

function makeChoice(index) {
    var choices = getChoicesByAge();
    if (index >= choices.length || index < 0) return;
    var choice = choices[index];
    applyEffect(choice.effect);
    gameState.events.push({ age: gameState.age, event: choice.text });
    if (checkGameOver()) return;
    gameState.age++;
    if (gameState.age > 80) { alert('ğŸ® æ­å–œé€šå…³ï¼æ´»åˆ°äº†' + gameState.age + 'å²ï¼'); return; }
    generateFortune();
    updateUI();
}

function submitFreeChoice() {
    var input = document.getElementById('freeInput');
    if (!input) return;
    var text = input.value.trim();
    if (!text) { alert('è¯·è¾“å…¥ä½ çš„æƒ³æ³•ï¼'); return; }
    
    var l = text.toLowerCase();
    var effect = {}, result = "", desc = "";
    
    // æ ¹æ®å¹´é¾„å’Œè¾“å…¥ç”Ÿæˆæ•ˆæœ
    if (gameState.age < 6) {
        effect = { health: 5, charm: 5 };
        result = "ä½ " + text + "ï¼Œå¼€å¿ƒåœ°æˆé•¿ç€ã€‚";
    } else if (gameState.age < 18) {
        if (l.indexOf('å­¦ä¹ ') !== -1) effect = { intelligence: 10 };
        else if (l.indexOf('ç©') !== -1) effect = { charm: 10, health: 5 };
        else effect = { health: 5, charm: 5 };
        result = "ä½ " + text + "ã€‚";
    } else {
        if (l.indexOf('å·¥ä½œ') !== -1) effect = { money: 5000, career: 1 };
        else if (l.indexOf('å­¦ä¹ ') !== -1) effect = { intelligence: 10 };
        else if (l.indexOf('å¥èº«') !== -1) effect = { health: 15 };
        else effect = { money: 2000, health: 5 };
        result = "ä½ " + text + "ã€‚";
    }
    
    applyEffect(effect);
    gameState.events.push({ age: gameState.age, event: text });
    if (checkGameOver()) return;
    gameState.age++;
    if (gameState.age > 80) { alert('ğŸ® æ­å–œé€šå…³ï¼'); return; }
    generateFortune();
    updateUI();
}

function updateUI() {
    var phase = getAgePhase(gameState.age);
    document.getElementById('yearDisplay').textContent = 'ğŸ‚ ç¬¬ ' + gameState.age + ' å¹´';
    document.getElementById('agePhase').textContent = phase.name;
    document.getElementById('health').textContent = gameState.health;
    document.getElementById('money').textContent = 'Â¥' + gameState.money;
    document.getElementById('intelligence').textContent = gameState.intelligence;
    document.getElementById('charm').textContent = gameState.charm;
    document.getElementById('luck').textContent = gameState.luck;
    document.getElementById('fame').textContent = gameState.fame;
    
    document.getElementById('healthBar').style.width = gameState.health + '%';
    document.getElementById('intBar').style.width = gameState.intelligence + '%';
    document.getElementById('charmBar').style.width = gameState.charm + '%';
    document.getElementById('luckBar').style.width = gameState.luck + '%';
    
    var avatars = ["ğŸ‘¶", "ğŸ‘¶", "ğŸ‘¶", "ğŸ§’", "ğŸ§’", "ğŸ§’", "ğŸ‘¦", "ğŸ‘¦", "ğŸ‘¦", "ğŸ‘¦", "ğŸ‘¦", "ğŸ‘¦", "ğŸ§‘", "ğŸ§‘", "ğŸ§‘", "ğŸ§‘", "ğŸ§‘", "ğŸ§‘", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘¨", "ğŸ‘´"];
    var names = ["å©´å„¿", "å©´å„¿", "å©´å„¿", "å¹¼å„¿", "å¹¼å„¿", "å¹¼å„¿", "å„¿ç«¥", "å„¿ç«¥", "å„¿ç«¥", "å„¿ç«¥", "å„¿ç«¥", "å„¿ç«¥", "å°‘å¹´", "å°‘å¹´", "å°‘å¹´", "å°‘å¹´", "å°‘å¹´", "å°‘å¹´", "é’å¹´", "é’å¹´", "é’å¹´", "é’å¹´", "é’å¹´", "é’å¹´", "ä¸­å¹´", "ä¸­å¹´", "ä¸­å¹´", "ä¸­å¹´", "ä¸­å¹´", "ä¸­å¹´", "è€å¹´"];
    document.getElementById('avatar').textContent = avatars[Math.min(gameState.age, avatars.length - 1)] || "ğŸ‘¨";
    document.getElementById('charName').textContent = names[Math.min(gameState.age, names.length - 1)] || "æˆäºº";
    document.getElementById('charInfo').textContent = gameState.age + 'å² Â· ' + gameState.job;
    
    document.getElementById('skillsList').innerHTML = gameState.skills.length ? 
        gameState.skills.map(function(s) { return '<span class="skill-tag">' + s + '</span>'; }).join('') : 
        '<span class="skill-tag">æ— </span>';
    
    document.getElementById('eventLog').innerHTML = gameState.events.slice(-5).map(function(e) {
        return '<div>ğŸŒŸ ' + e.age + 'å² - ' + e.event + '</div>';
    }).join('');
    
    var evt = getCurrentEvent();
    document.getElementById('sceneImage').textContent = evt.scene;
    document.getElementById('npcAvatar').innerHTML = evt.avatar + '<div class="speak-btn" onclick="speakText()">ğŸ”Š</div>';
    document.getElementById('npcName').textContent = evt.npc;
    document.getElementById('dialogueText').textContent = evt.dialogue;
    
    var choices = getChoicesByAge();
    document.getElementById('choicesList').innerHTML = choices.map(function(c, i) {
        return '<button class="choice-btn" onclick="makeChoice(' + i + ')">' + c.text + '<div class="choice-desc">' + c.desc + '</div></button>';
    }).join('');
}

generateGoal();
generateFortune();
document.getElementById('submitBtn').onclick = function() { submitFreeChoice(); };
updateUI();
</script>
</body>
</html>
