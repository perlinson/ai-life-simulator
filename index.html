<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ğŸ® AIäººç”Ÿæ¨¡æ‹Ÿå™¨</title>
<style>
body{font-family:'Microsoft YaHei';background:#1a1a2e;color:#fff;padding:20px;margin:0;min-height:100vh}
.game-container{max-width:900px;margin:0 auto}
.year-display{text-align:center;font-size:28px;color:#ffd700;margin-bottom:10px}
.age-phase{text-align:center;font-size:14px;color:#00ff88;margin-bottom:15px}
.goal-box{text-align:center;background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,204,255,0.1));padding:10px;border-radius:10px;margin-bottom:15px;border:1px solid rgba(0,255,136,0.3)}
.goal-label{font-size:12px;color:#00ff88}
.goal-text{font-size:14px;color:#fff}
.fortune-box{text-align:center;background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,165,0,0.2));padding:8px;border-radius:10px;margin-bottom:15px;border:1px solid rgba(255,215,0,0.3)}
.fortune-label{font-size:12px;color:#ffd700}
.fortune-text{font-size:13px;color:#fff}
.status-bar{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin-bottom:15px}
.stat-item{background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;text-align:center}
.stat-label{font-size:10px;color:#888;margin-bottom:4px}
.stat-value{font-size:14px;font-weight:bold}
.stat-bar{height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-top:4px;overflow:hidden}
.stat-fill{height:100%;border-radius:2px;transition:width 0.3s}
.main-area{display:grid;grid-template-columns:200px 1fr;gap:20px}
@media(max-width:750px){.main-area{grid-template-columns:1fr}.status-bar{grid-template-columns:repeat(3,1fr)}}
.avatar{font-size:50px;text-align:center;margin-bottom:10px}
.char-name{text-align:center;font-size:18px;margin-bottom:5px}
.char-info{text-align:center;color:#888;font-size:12px}
.skills-list{display:flex;flex-wrap:wrap;gap:5px;margin-top:10px}
.skill-tag{background:rgba(255,255,255,0.1);padding:3px 8px;border-radius:10px;font-size:11px}
.event-log{font-size:11px;max-height:150px;overflow-y:auto;margin-top:10px}
.story-panel{background:rgba(0,0,0,0.3);padding:15px;border-radius:10px;flex:1}
.scene-image{font-size:40px;text-align:center;margin-bottom:10px}
.npc-area{display:flex;gap:10px;margin-bottom:10px;align-items:flex-start}
.npc-avatar{font-size:30px;position:relative;cursor:pointer}
.speak-btn{position:absolute;bottom:-5px;right:-5px;font-size:12px;background:#00ff88;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center}
.dialogue-box{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px;flex:1}
.npc-name{color:#ffd700;font-size:12px;margin-bottom:5px}
.choices-title{font-size:14px;color:#00ccff;margin:10px 0}
.choice-btn{display:block;width:100%;padding:12px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff;text-align:left;margin-bottom:8px;cursor:pointer;transition:all 0.2s}
.choice-btn:hover{background:rgba(0,255,136,0.2);border-color:#00ff88;transform:translateX(5px)}
.choice-btn.legendary{background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(255,165,0,0.3));border-color:#ffd700}
.choice-btn.legendary:hover{background:linear-gradient(135deg,rgba(255,215,0,0.5),rgba(255,165,0,0.5))}
.choice-desc{font-size:11px;color:#888;margin-top:3px}
.legendary-tag{font-size:10px;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#000;padding:2px 6px;border-radius:8px;margin-left:5px}
.free-input{margin-top:15px}
.free-input input{width:100%;padding:10px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff}
.free-input button{margin-top:8px;padding:10px 20px;background:#00ff88;border:none;border-radius:8px;color:#000;font-weight:bold;cursor:pointer}
</style>
</head>
<body>
<div class="game-container">
<div class="year-display" id="yearDisplay">ğŸ‚ ç¬¬ 0 å¹´</div>
<div class="age-phase" id="agePhase">ğŸ‘¶ å©´å„¿æœŸ</div>

<div class="goal-box">
<div class="goal-label">ğŸ¯ äººç”Ÿç›®æ ‡</div>
<div class="goal-text" id="goalText">éšæœºç”Ÿæˆä¸­...</div>
</div>

<div class="fortune-box">
<div class="fortune-label">ğŸ”® ä»Šå¹´è¿åŠ¿</div>
<div class="fortune-text" id="fortuneText">ç‚¹å‡»æŸ¥çœ‹</div>
</div>

<div class="status-bar">
<div class="stat-item"><div class="stat-label">â¤ï¸ ç”Ÿå‘½</div><div class="stat-value" id="life">100</div><div class="stat-bar"><div class="stat-fill" id="lifeBar" style="width:100%;background:#ff4444"></div></div></div>
<div class="stat-item"><div class="stat-label">ğŸ’š å¥åº·</div><div class="stat-value" id="health">100</div><div class="stat-bar"><div class="stat-fill" id="healthBar" style="width:100%;background:#00ff88"></div></div></div>
<div class="stat-item"><div class="stat-label">ğŸ’° é‡‘é’±</div><div class="stat-value" id="money">Â¥0</div></div>
<div class="stat-item"><div class="stat-label">ğŸ§  æ™ºåŠ›</div><div class="stat-value" id="intelligence">50</div><div class="stat-bar"><div class="stat-fill" id="intBar" style="width:25%;background:#00ccff"></div></div></div>
<div class="stat-item"><div class="stat-label">âœ¨ é­…åŠ›</div><div class="stat-value" id="charm">50</div><div class="stat-bar"><div class="stat-fill" id="charmBar" style="width:25%;background:#ff6b6b"></div></div></div>
<div class="stat-item"><div class="stat-label">ğŸ€ å¹¸è¿</div><div class="stat-value" id="luck">50</div><div class="stat-bar"><div class="stat-fill" id="luckBar" style="width:25%;background:#ffd700"></div></div></div>
<div class="stat-item"><div class="stat-label">â­ å£°æœ›</div><div class="stat-value" id="fame">0</div></div>
</div>

<div class="main-area">
<div class="left-panel">
<div class="avatar" id="avatar">ğŸ‘¶</div>
<div class="char-name" id="charName">å©´å„¿</div>
<div class="char-info" id="charInfo">0å²</div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">ğŸ¯ æŠ€èƒ½</div><div class="skills-list" id="skillsList"><span class="skill-tag">æ— </span></div></div>
<div style="margin-top:15px"><div style="color:#00ff88;font-size:12px;margin-bottom:5px">ğŸ“œ ç»å†</div><div class="event-log" id="eventLog"><div>ğŸŒŸ ä½ å‡ºç”Ÿäº†</div></div></div>
</div>
<div class="center-area">
<div class="story-panel">
<div class="scene-image" id="sceneImage">ğŸ¥</div>
<div class="npc-area">
<div class="npc-avatar" id="npcAvatar" onclick="speakText()">ğŸ‘©<div class="speak-btn">ğŸ”Š</div></div>
<div class="dialogue-box">
<div class="npc-name" id="npcName">å¦ˆå¦ˆ</div>
<div id="dialogueText">å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼</div>
</div>
</div>
</div>
<div class="choices-panel" id="choicesPanel">
<div class="choices-title">âœ¨ ä½ å†³å®šï¼š</div>
<div id="choicesList"></div>
<div class="free-input"><input type="text" id="freeInput" placeholder="ğŸ’¬ è¾“å…¥ä½ çš„æƒ³æ³•"><button id="submitBtn">æäº¤</button></div>
</div>
</div>
</div>
</div>

<script>
var gameState = {
    age: 0,
    life: 100,
    health: 100,
    money: 0,
    intelligence: 50,
    charm: 50,
    luck: 50,
    fame: 0,
    skills: [],
    events: [],
    job: "å©´å„¿",
    relationship: 0,
    careerLevel: 0,
    education: 0,
    goal: "",
    fortune: ""
};

var goals = ["æˆä¸ºäº¿ä¸‡å¯Œç¿ ğŸ¤‘", "æ‰¾åˆ°çœŸçˆ± ğŸ’•", "ç¯æ¸¸ä¸–ç•Œ ğŸŒ", "æ”¹å˜ä¸–ç•Œ ğŸŒ", "æˆä¸ºè¡Œä¸šç²¾è‹± ğŸ’¼", "æ‹¥æœ‰å¹¸ç¦å®¶åº­ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§", "æ´»åˆ°100å² ğŸ‚", "æˆä¸ºçŸ¥åäººç‰© â­", "å¸®åŠ©ä»–äºº ğŸ™Œ", "å®ç°è´¢åŠ¡è‡ªç”± ğŸ’°", "æ‹¥æœ‰è‡ªå·±çš„å…¬å¸ ğŸ¢", "æˆä¸ºè‰ºæœ¯å®¶ ğŸ¨"];
var fortunes = ["ä»Šå¹´äº‹ä¸šè¿åŠ¿ä¸é”™ ğŸ’ª", "å¥åº·è¿åŠ¿ä¸‹æ»‘ï¼Œæ³¨æ„èº«ä½“ âš ï¸", "è´¢è¿äº¨é€š ğŸ’°", "äººé™…å…³ç³»æ´»è·ƒ ğŸ¤", "å­¦ä¹ è¿åŠ¿æ—ºç›› ğŸ“š", "çˆ±æƒ…è¿åŠ¿æ¥ä¸´ ğŸ’•", "æ•´ä½“å¹³ç¨³ ğŸŒŠ", "æŒ‘æˆ˜ä¸æœºé‡å¹¶å­˜ ğŸš€", "é€‚åˆä¼‘æ¯ ğŸ§˜", "åˆ›é€ åŠ›çˆ†å‘ ğŸ¨"];

function getAgePhase(age) {
    if (age < 3) return { name: "ğŸ‘¶ å©´å„¿æœŸ", npc: "å¦ˆå¦ˆ", scene: "ğŸ¥", avatar: "ğŸ‘©" };
    if (age < 6) return { name: "ğŸ§’ å¹¼å„¿æœŸ", npc: "çˆ¸çˆ¸", scene: "ğŸ ", avatar: "ğŸ‘¨" };
    if (age < 12) return { name: "ğŸ« å°å­¦æœŸ", npc: "è€å¸ˆ", scene: "ğŸ«", avatar: "ğŸ‘¨â€ğŸ«" };
    if (age < 18) return { name: "ğŸ“š ä¸­å­¦æœŸ", npc: "ç­ä¸»ä»»", scene: "ğŸ«", avatar: "ğŸ‘©â€ğŸ«" };
    if (age < 22) return { name: "ğŸ“ å¤§å­¦æœŸ", npc: "å­¦é•¿", scene: "ğŸ«", avatar: "ğŸ‘¨â€ğŸ“" };
    if (age < 30) return { name: "ğŸ’¼ åˆèŒæœŸ", npc: "ä¸Šå¸", scene: "ğŸ¢", avatar: "ğŸ‘¨â€ğŸ’¼" };
    if (age < 45) return { name: "ğŸ¢ èŒä¸šæœŸ", npc: "åŒäº‹", scene: "ğŸ¢", avatar: "ğŸ‘”" };
    if (age < 60) return { name: "ğŸ‘” ä¸­å¹´æœŸ", npc: "æœ‹å‹", scene: "ğŸ ", avatar: "ğŸ‘«" };
    return { name: "ğŸ‘´ è€å¹´æœŸ", npc: "å­å¥³", scene: "ğŸ ", avatar: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§" };
}

function getChoicesByAge() {
    var age = gameState.age;
    var choices = [];
    
    if (age < 3) {
        choices = [
            { text: "ğŸ˜Š å¥åº·æˆé•¿", effect: { health: 20 }, result: "ä½ å¥åº·æˆé•¿ç€ï¼", desc: "å¥åº·+20" },
            { text: "ğŸ˜¢ å“­é—¹è¡¨è¾¾", effect: { charm: 10 }, result: "ä½ ç”¨å“­é—¹æ¥è¡¨è¾¾éœ€æ±‚ã€‚", desc: "é­…åŠ›+10" },
            { text: "ğŸ˜´ å®‰é™ç¡è§‰", effect: { health: 15 }, result: "ä½ å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç¡è§‰ã€‚", desc: "å¥åº·+15" },
            { text: "ğŸ‘€ å¥½å¥‡è§‚å¯Ÿ", effect: { intelligence: 15, luck: 5 }, result: "ä½ å¥½å¥‡åœ°è§‚å¯Ÿä¸–ç•Œã€‚", desc: "æ™ºåŠ›+15, å¹¸è¿+5" }
        ];
    } else if (age < 6) {
        choices = [
            { text: "ğŸš— ç©ç©å…·è½¦", effect: { intelligence: 20, skill: "æœºæ¢°" }, result: "ä½ å¯¹æœºæ¢°ç©å…·çˆ±ä¸é‡Šæ‰‹ï¼", desc: "æ™ºåŠ›+20" },
            { text: "ğŸ¨ ç”»ç”»", effect: { intelligence: 15, skill: "ç»˜ç”»", charm: 10 }, result: "ä½ æœ€å–œæ¬¢æ¶‚ç”»ã€‚", desc: "æ™ºåŠ›+15, é­…åŠ›+10" },
            { text: "ğŸ‘« äº¤å°æœ‹å‹", effect: { charm: 25, skill: "ç¤¾äº¤" }, result: "ä½ äº¤åˆ°äº†å¥½æœ‹å‹ï¼", desc: "é­…åŠ›+25" },
            { text: "ğŸ“– å¬æ•…äº‹", effect: { intelligence: 20, luck: 5 }, result: "ä½ æ²‰æµ¸åœ¨æ•…äº‹ä¸­ã€‚", desc: "æ™ºåŠ›+20, å¹¸è¿+5" }
        ];
    } else if (age < 12) {
        choices = [
            { text: "ğŸ“ å­¦æ•°å­¦", effect: { intelligence: 30, skill: "æ•°å­¦" }, result: "ä½ å±•ç°äº†æ•°å­¦å¤©èµ‹ï¼", desc: "æ™ºåŠ›+30" },
            { text: "ğŸ“š è¯»è¯¾å¤–ä¹¦", effect: { intelligence: 25, skill: "é˜…è¯»", luck: 10 }, result: "ä½ è¯»äº†å¾ˆå¤šè¯¾å¤–ä¹¦ã€‚", desc: "æ™ºåŠ›+25, å¹¸è¿+10" },
            { text: "âš½ è¸¢è¶³çƒ", effect: { health: 30, skill: "è¶³çƒ" }, result: "ä½ æˆäº†è¶³çƒé˜Ÿä¸»åŠ›ï¼", desc: "å¥åº·+30" },
            { text: "ğŸµ å­¦é’¢ç´", effect: { charm: 20, skill: "é’¢ç´", money: -5000 }, result: "ä½ å­¦ä¼šäº†å¼¹é’¢ç´ï¼", desc: "é­…åŠ›+20, Â¥5000" }
        ];
        if (gameState.money >= 3000) choices.push({ text: "ğŸ“š ä¸Šå¥¥æ•°ç­", effect: { intelligence: 25, money: -3000, skill: "ç«èµ›æ•°å­¦" }, result: "ä½ å¥¥æ•°è·å¥–äº†ï¼", desc: "æ™ºåŠ›+25", legendary: true });
    } else if (age < 18) {
        choices = [
            { text: "ğŸ“– åŠªåŠ›å­¦ä¹ ", effect: { intelligence: 30, education: 1 }, result: "ä½ æˆç»©ä¼˜å¼‚ï¼", desc: "æ™ºåŠ›+30" },
            { text: "ğŸ€ æ‰“ç¯®çƒ", effect: { health: 30, charm: 20, skill: "ç¯®çƒ" }, result: "ä½ æˆäº†ç¯®çƒé˜Ÿé•¿ï¼", desc: "å¥åº·+30, é­…åŠ›+20" },
            { text: "ğŸ’• è°ˆæ‹çˆ±", effect: { relationship: 40, charm: 20 }, result: "ä½ å¼€å§‹äº†æ‹æƒ…ã€‚", desc: "å…³ç³»+40, é­…åŠ›+20" },
            { text: "ğŸ® ç©æ¸¸æˆ", effect: { charm: 15, intelligence: -10 }, result: "ä½ æ²‰è¿·æ¸¸æˆã€‚", desc: "é­…åŠ›+15, æ™ºåŠ›-10" }
        ];
        if (gameState.intelligence >= 120) choices.push({ text: "ğŸ† å‚åŠ å¥¥èµ›", effect: { fame: 50, intelligence: 30, skill: "ç«èµ›" }, result: "ä½ è·å¾—å›½é™…å¥¥èµ›é‡‘ç‰Œï¼", desc: "å£°æœ›+50, æ™ºåŠ›+30", legendary: true });
        if (gameState.charm >= 100) choices.push({ text: "ğŸŒŸ æˆä¸ºæ ¡è‰", effect: { fame: 40, charm: 30 }, result: "ä½ æˆäº†æ ¡è‰ï¼", desc: "å£°æœ›+40, é­…åŠ›+30", legendary: true });
    } else if (age < 22) {
        choices = [
            { text: "ğŸ“š è€ƒç ”æ·±é€ ", effect: { intelligence: 30, money: -10000, education: 2 }, result: "ä½ å†³å®šè€ƒç ”ï¼", desc: "æ™ºåŠ›+30, æ•™è‚²+2" },
            { text: "ğŸ’¼ æ‰¾å®ä¹ ", effect: { money: 5000, skill: "å·¥ä½œç»éªŒ", career: 1 }, result: "ä½ æ‰¾åˆ°äº†å®ä¹ ã€‚", desc: "Â¥5000, ç»éªŒ+1" },
            { text: "ğŸ­ å‚åŠ ç¤¾å›¢", effect: { charm: 30, skill: "ç¤¾äº¤" }, result: "ä½ è®¤è¯†äº†å¾ˆå¤šæœ‹å‹ï¼", desc: "é­…åŠ›+30" },
            { text: "ğŸ® æ‰“æ¸¸æˆ", effect: { charm: 20 }, result: "ä½ äº«å—å¤§å­¦ç”Ÿæ´»ã€‚", desc: "é­…åŠ›+20" }
        ];
        if (gameState.intelligence >= 140) choices.push({ text: "ğŸš€ åˆ›ä¸šå¤§èµ›", effect: { money: 50000, fame: 60, skill: "åˆ›ä¸š" }, result: "ä½ è·å¾—åˆ›ä¸šå¤§èµ›å† å†›ï¼", desc: "Â¥50000, å£°æœ›+60", legendary: true });
        if (gameState.money >= 50000) choices.push({ text: "ğŸ’° æŠ•èµ„åˆ›ä¸š", effect: { money: -20000, fame: 40, skill: "åˆ›ä¸š" }, result: "ä½ å¼€å§‹åˆ›ä¸šäº†ï¼", desc: "Â¥20000, å£°æœ›+40", legendary: true });
    } else if (age < 30) {
        choices = [
            { text: "ğŸ’ª æ‹¼å‘½å·¥ä½œ", effect: { money: 30000, career: 3, health: -15 }, result: "ä½ æ‹¼å‘½å·¥ä½œï¼", desc: "Â¥30000, èŒçº§+3, å¥åº·-15" },
            { text: "ğŸ’• æ‰¾å¯¹è±¡", effect: { relationship: 50, charm: 20 }, result: "ä½ æ‰¾åˆ°äº†å¦ä¸€åŠï¼", desc: "å…³ç³»+50, é­…åŠ›+20" },
            { text: "ğŸ“š ç»§ç»­å­¦ä¹ ", effect: { intelligence: 25, money: -10000, skill: "ä¸“ä¸šæŠ€èƒ½" }, result: "ä½ è€ƒå–äº†è¯ä¹¦ï¼", desc: "æ™ºåŠ›+25, æŠ€èƒ½" },
            { text: "ğŸŒ´ äº«å—ç”Ÿæ´»", effect: { health: 20, money: -10000 }, result: "ä½ å¥½å¥½äº«å—ç”Ÿæ´»ã€‚", desc: "å¥åº·+20, Â¥10000" }
        ];
        if (gameState.careerLevel >= 10) choices.push({ text: "ğŸ¢ æ™‹å‡æ€»ç›‘", effect: { money: 100000, fame: 80, career: 5 }, result: "ä½ æˆåŠŸæ™‹å‡æ€»ç›‘ï¼", desc: "Â¥100000, å£°æœ›+80", legendary: true });
        if (gameState.relationship >= 100) choices.push({ text: "ğŸ’ ç»“å©š", effect: { relationship: 100, money: -50000, health: 20 }, result: "ä½ ç»“å©šäº†ï¼", desc: "å…³ç³»+100, Â¥50000", legendary: true });
    } else if (age < 45) {
        choices = [
            { text: "ğŸ’¼ ä¸“æ³¨äº‹ä¸š", effect: { money: 50000, career: 3, health: -10 }, result: "ä½ ä¸“æ³¨äºäº‹ä¸šå‘å±•ã€‚", desc: "Â¥50000, èŒçº§+3" },
            { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç»“å©šç”Ÿå­", effect: { relationship: 60, money: -80000, health: -5 }, result: "ä½ ç»„æˆäº†å®¶åº­ï¼", desc: "å…³ç³»+60, Â¥80000" },
            { text: "ğŸ“ˆ æŠ•èµ„ç†è´¢", effect: { money: Math.floor(Math.random() * 100000 - 10000), skill: "æŠ•èµ„" }, result: "æŠ•èµ„æ”¶ç›Šä¸ç¡®å®šã€‚", desc: "æœ‰é£é™©" },
            { text: "ğŸƒ é”»ç‚¼èº«ä½“", effect: { health: 40 }, result: "ä½ åšæŒé”»ç‚¼ï¼", desc: "å¥åº·+40" }
        ];
        if (gameState.money >= 500000) choices.push({ text: "ğŸ­ æ”¶è´­å…¬å¸", effect: { money: -300000, fame: 150, career: 10 }, result: "ä½ æ”¶è´­äº†ä¸€å®¶å…¬å¸ï¼", desc: "Â¥300000, å£°æœ›+150", legendary: true });
        if (gameState.fame >= 100) choices.push({ text: "ğŸ“º ä¸Šç”µè§†", effect: { fame: 100, charm: 50 }, result: "ä½ ä¸Šäº†ç”µè§†ï¼", desc: "å£°æœ›+100, é­…åŠ›+50", legendary: true });
    } else if (age < 60) {
        choices = [
            { text: "ğŸ’¼ ç¨³å®šå·¥ä½œ", effect: { money: 40000, health: -10 }, result: "ä½ å·¥ä½œç¨³å®šã€‚", desc: "Â¥40000, å¥åº·-10" },
            { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç…§é¡¾å®¶åº­", effect: { relationship: 40, health: 20 }, result: "ä½ äº«å—å¤©ä¼¦ä¹‹ä¹ã€‚", desc: "å…³ç³»+40, å¥åº·+20" },
            { text: "ğŸ“š ç»§ç»­å­¦ä¹ ", effect: { intelligence: 30, skill: "æ–°æŠ€èƒ½" }, result: "ä½ å­¦ä¹ æ–°æŠ€èƒ½ã€‚", desc: "æ™ºåŠ›+30" },
            { text: "ğŸƒ å…»ç”Ÿä¿å¥", effect: { health: 50 }, result: "ä½ æ³¨é‡å…»ç”Ÿã€‚", desc: "å¥åº·+50" }
        ];
        if (gameState.fame >= 200) choices.push({ text: "ğŸ¤ æ¼”è®²", effect: { fame: 80 }, result: "ä½ è¿›è¡Œäº†ä¸€åœºæ¼”è®²ï¼", desc: "å£°æœ›+80", legendary: true });
    } else {
        choices = [
            { text: "âœï¸ å†™å›å¿†å½•", effect: { fame: 50, intelligence: 20 }, result: "ä½ å¼€å§‹å†™å›å¿†å½•ã€‚", desc: "å£°æœ›+50" },
            { text: "ğŸ‘¶ å«é¥´å¼„å­™", effect: { health: 30, relationship: 40 }, result: "ä½ äº«å—å¤©ä¼¦ä¹‹ä¹ï¼", desc: "å¥åº·+30, å…³ç³»+40" },
            { text: "ğŸŒ å‘¨æ¸¸ä¸–ç•Œ", effect: { money: -100000, charm: 50 }, result: "ä½ å»å‘¨æ¸¸ä¸–ç•Œï¼", desc: "Â¥100000, é­…åŠ›+50" },
            { text: "ğŸŒ± ç§èŠ±å…»è‰", effect: { health: 40, luck: 20 }, result: "ä½ è¿‡èµ·æ‚ é—²ç”Ÿæ´»ã€‚", desc: "å¥åº·+40, å¹¸è¿+20" }
        ];
        if (gameState.fame >= 300) choices.push({ text: "ğŸ‘‘ æ¥å—é‡‡è®¿", effect: { fame: 100 }, result: "ä½ æ¥å—äº†é‡‡è®¿ï¼", desc: "å£°æœ›+100", legendary: true });
    }
    
    return choices;
}

function getCurrentEvent() {
    var phase = getAgePhase(gameState.age);
    return {
        npc: phase.npc,
        scene: phase.scene,
        avatar: phase.avatar,
        dialogue: getDialogue(gameState.age),
        choices: getChoicesByAge()
    };
}

function getDialogue(age) {
    var d = { 0: "å®è´ï¼Œæ¬¢è¿æ¥åˆ°è¿™ä¸ªä¸–ç•Œï¼", 3: "3å²äº†ï¼Œè¯¥ä¸Šå¹¼å„¿å›­äº†ã€‚", 6: "ä¸Šå°å­¦äº†ï¼", 12: "ä¸Šåˆä¸­äº†ã€‚", 15: "é«˜ä¸­äº†ï¼Œè¦è€ƒå¤§å­¦äº†ï¼", 18: "18å²äº†ï¼Œæˆå¹´äº†ã€‚", 22: "å¤§å­¦æ¯•ä¸šäº†ã€‚", 30: "30è€Œç«‹ä¹‹å¹´ã€‚", 40: "40ä¸æƒ‘ä¹‹å¹´ã€‚", 50: "50çŸ¥å¤©å‘½ã€‚", 60: "60èŠ±ç”²ï¼Œè¯¥é€€ä¼‘äº†ã€‚" };
    for (var i = age; i >= 0; i--) if (d[i]) return d[i];
    return "ä»Šå¹´ä½ " + age + "å²äº†...";
}

function generateGoal() { gameState.goal = goals[Math.floor(Math.random() * goals.length)]; document.getElementById('goalText').textContent = gameState.goal; }
function generateFortune() { gameState.fortune = fortunes[Math.floor(Math.random() * fortunes.length)]; document.getElementById('fortuneText').textContent = gameState.fame > 100 ? "â­ é¸¿è¿å½“å¤´ï¼" : gameState.fortune; }

function speakText() {
    var utterance = new SpeechSynthesisUtterance(document.getElementById('dialogueText').textContent);
    utterance.lang = 'zh-CN';
    speechSynthesis.speak(utterance);
}

function applyEffect(effect) {
    if (!effect) return;
    if (effect.money) gameState.money += effect.money;
    if (effect.life) gameState.life += effect.life;
    if (effect.health) gameState.health += effect.health;
    if (effect.intelligence) gameState.intelligence += effect.intelligence;
    if (effect.charm) gameState.charm += effect.charm;
    if (effect.luck) gameState.luck += effect.luck;
    if (effect.fame) gameState.fame += effect.fame;
    if (effect.career) gameState.careerLevel += effect.career;
    if (effect.relationship) gameState.relationship += effect.relationship;
    if (effect.education) gameState.education += effect.education;
    if (effect.job) gameState.job = effect.job;
    if (effect.skill && gameState.skills.indexOf(effect.skill) === -1) gameState.skills.push(effect.skill);
    
    gameState.life = Math.max(0, Math.min(100, gameState.life));
    gameState.health = Math.max(0, Math.min(200, gameState.health));
    gameState.intelligence = Math.max(0, Math.min(200, gameState.intelligence));
    gameState.charm = Math.max(0, Math.min(200, gameState.charm));
    gameState.luck = Math.max(0, Math.min(200, gameState.luck));
}

function checkGameOver() {
    if (gameState.life <= 0) { alert('ğŸ’€ æ¸¸æˆç»“æŸï¼ç”Ÿå‘½è€—å°½'); return true; }
    if (gameState.money < -200000) { alert('ğŸ’¸ æ¸¸æˆç»“æŸï¼è´Ÿå€ºè¿‡å¤š'); return true; }
    return false;
}

function makeChoice(index) {
    var choices = getChoicesByAge();
    if (index >= choices.length || index < 0) return;
    var choice = choices[index];
    applyEffect(choice.effect);
    gameState.events.push({ age: gameState.age, event: choice.text });
    if (checkGameOver()) return;
    gameState.age++;
    if (gameState.age > 90) { alert('ğŸ® æ­å–œé€šå…³ï¼æ´»åˆ°äº†' + gameState.age + 'å²ï¼'); return; }
    generateFortune();
    updateUI();
}

function submitFreeChoice() {
    var input = document.getElementById('freeInput');
    if (!input || !input.value.trim()) { alert('è¯·è¾“å…¥ä½ çš„æƒ³æ³•ï¼'); return; }
    var text = input.value.trim();
    var l = text.toLowerCase();
    var effect = {}, result = "";
    
    if (gameState.age < 6) effect = { health: 10, charm: 5 };
    else if (gameState.age < 18) effect = l.indexOf('å­¦ä¹ ') !== -1 ? { intelligence: 20 } : { health: 15, charm: 10 };
    else effect = l.indexOf('å·¥ä½œ') !== -1 ? { money: 10000, career: 1, health: -5 } : l.indexOf('å¥èº«') !== -1 ? { health: 30 } : { money: 5000, health: 10 };
    
    applyEffect(effect);
    gameState.events.push({ age: gameState.age, event: text });
    if (checkGameOver()) return;
    gameState.age++;
    if (gameState.age > 90) { alert('ğŸ® æ­å–œé€šå…³ï¼'); return; }
    generateFortune();
    updateUI();
}

function updateUI() {
    var phase = getAgePhase(gameState.age);
    document.getElementById('yearDisplay').textContent = 'ğŸ‚ ç¬¬ ' + gameState.age + ' å¹´';
    document.getElementById('agePhase').textContent = phase.name;
    document.getElementById('life').textContent = gameState.life + '/100';
    document.getElementById('health').textContent = gameState.health + '/200';
    document.getElementById('money').textContent = 'Â¥' + gameState.money.toLocaleString();
    document.getElementById('intelligence').textContent = gameState.intelligence + '/200';
    document.getElementById('charm').textContent = gameState.charm + '/200';
    document.getElementById('luck').textContent = gameState.luck + '/200';
    document.getElementById('fame').textContent = gameState.fame;
    
    document.getElementById('lifeBar').style.width = gameState.life + '%';
    document.getElementById('healthBar').style.width = (gameState.health / 2) + '%';
    document.getElementById('intBar').style.width = (gameState.intelligence / 2) + '%';
    document.getElementById('charmBar').style.width = (gameState.charm / 2) + '%';
    document.getElementById('luckBar').style.width = (gameState.luck / 2) + '%';
    
    var avatars = ["ğŸ‘¶","ğŸ‘¶","ğŸ‘¶","ğŸ§’","ğŸ§’","ğŸ§’","ğŸ‘¦","ğŸ‘¦","ğŸ‘¦","ğŸ‘¦","ğŸ‘¦","ğŸ‘¦","ğŸ§‘","ğŸ§‘","ğŸ§‘","ğŸ§‘","ğŸ§‘","ğŸ§‘","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘¨","ğŸ‘´"];
    var names = ["å©´å„¿","å©´å„¿","å©´å„¿","å¹¼å„¿","å¹¼å„¿","å¹¼å„¿","å„¿ç«¥","å„¿ç«¥","å„¿ç«¥","å„¿ç«¥","å„¿ç«¥","å„¿ç«¥","å°‘å¹´","å°‘å¹´","å°‘å¹´","å°‘å¹´","å°‘å¹´","å°‘å¹´","é’å¹´","é’å¹´","é’å¹´","é’å¹´","é’å¹´","é’å¹´","ä¸­å¹´","ä¸­å¹´","ä¸­å¹´","ä¸­å¹´","ä¸­å¹´","ä¸­å¹´","è€å¹´"];
    document.getElementById('avatar').textContent = avatars[Math.min(gameState.age, avatars.length - 1)] || "ğŸ‘¨";
    document.getElementById('charName').textContent = names[Math.min(gameState.age, names.length - 1)] || "æˆäºº";
    document.getElementById('charInfo').textContent = gameState.age + 'å² Â· ' + gameState.job;
    
    document.getElementById('skillsList').innerHTML = gameState.skills.length ? gameState.skills.map(function(s) { return '<span class="skill-tag">' + s + '</span>'; }).join('') : '<span class="skill-tag">æ— </span>';
    document.getElementById('eventLog').innerHTML = gameState.events.slice(-5).map(function(e) { return '<div>ğŸŒŸ ' + e.age + 'å² - ' + e.event + '</div>'; }).join('');
    
    var evt = getCurrentEvent();
    document.getElementById('sceneImage').textContent = evt.scene;
    document.getElementById('npcAvatar').innerHTML = evt.avatar + '<div class="speak-btn" onclick="speakText()">ğŸ”Š</div>';
    document.getElementById('npcName').textContent = evt.npc;
    document.getElementById('dialogueText').textContent = evt.dialogue;
    
    var choices = getChoicesByAge();
    document.getElementById('choicesList').innerHTML = choices.map(function(c, i) {
        var cls = c.legendary ? 'choice-btn legendary' : 'choice-btn';
        var tag = c.legendary ? '<span class="legendary-tag">â­ ç¨€æœ‰</span>' : '';
        return '<button class="' + cls + '" onclick="makeChoice(' + i + ')">' + c.text + tag + '<div class="choice-desc">' + c.desc + '</div></button>';
    }).join('');
}

generateGoal();
generateFortune();
document.getElementById('submitBtn').onclick = function() { submitFreeChoice(); };
updateUI();
</script>
</body>
</html>
